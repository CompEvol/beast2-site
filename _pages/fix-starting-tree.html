---
layout: site
title: Fix starting tree 
tags: []
---

	
		<p>To start the tree with a tree in Newick format, you need the TreeParser to initialise the tree. You can insert this in the XML by editing it (this is not possible in BEAUti yet) for example, like so:</p>

		
		
			
			
			
			{% highlight xml %}<stateNode spec='beast.util.TreeParser' id='Tree.t:xyz' IsLabelledNewick='true' adjustTipHeights='false'
 taxa='@xyz'
 newick="(((((chimp:0.009603178109055574,bonobo:0.009603178109055574):0.01049225186311567):0.013418689384830318):0.02460624740645495,orangutan:0.05812036676345651):0.010656607109573349,siamang:0.06877697387302986);"/>{% endhighlight %}
			
		

<p>It is a bit tricky, because you have to ensure that</p>
<ul>
<li>the id (here id=&#8217;Tree.t:xyz&#8217;) is the same as in your original file.</li>
<li>taxa refers to the alignment so it knows the order of taxa. If your alignment has id=&#8217;xyz&#8217; then add taxa=&#8217;@xyz&#8217;.</li>
<li>the element name (here stateNode) should be the same as in the original file.</li>
<li>if the tree is supposed to be ultrametric, that is, all the tips have the same age then also set adjustTipHeights to true.</li>
<li>if there is an initaliser generated by BEAUti of the form</li>
</ul>
<p></p>

		
		
			
			
			
			{% highlight xml %}   <init estimate="false" id="RandomTree.t:xxx" initial="@Tree.t:xxx" spec="beast.evolution.tree.RandomTree" taxa="@xxx">{% endhighlight %}			
			
		

<p>remove this element from the file, otherwise the tree will be Newick tree will be overwritten by a random tree.</p>
<ul>
<li>if you added constraints to the RandomTree in &#8220;constraint&#8221;-elements, these should not be moved to TreeParser. TreeParser does not rely on constraints to initialise, so these constraints should be moved outside the RandomTree to the top level of the XML (just inside the &#8220;beast&#8221;-element).</li>
</ul>
<p>For more information about starting threes, including for *BEAST, see <a href="/2014/07/28/all-about-starting-trees">All about starting trees</a>.</p>
	


<h2>Fix the tree throughout BEAST run</h2>

If you want to keep the tree fixed during the MCMC chain, you need to remove operators that operate on the tree. To remove an operator you can
<ul>
<li>set the operator weight to 0, in the operator panel in BEAUti (make sure the operator panel is visible by selecting the View/Show Operators panel menu first), or</li>
<li>set the operator weight to 0 in the XML, or</li>
<li>comment out (wrap inside &lt;!-- and --&gt;) or delete the operator by editing the XML</li>
</ul>
For a standard analysis (one generated in BEAUti using the Standard template) you can keep the topology fixed by removing the following operators
<ul>
<li>Wide-exchange, which are elements with spec="Exchange" and isNarrow="false" </li>
<li>Narrow-exchange, elements with spec="Exchange" and isNarrow not specified </li>
<li>Wilson-Balding, elements with spec="WilsonBalding"</li>
<li>Subtree-slide, elements with spec="SubtreeSlide"</li>
</ul>

If you also want to keep the height of the internal nodes fixed, on top of removing the above operators you need to remove 
<ul>
<li>Tree-scaler, which are elements with spec="ScaleOperator" and id containing "TreeScaler"</li>
<li>Tree-root-scaler, elements with spec="ScaleOperator" and id containing "TreeRootScaler"</li>
<li>Uniform, elements with spec="Uniform"</li>
<li>Up-down-operators, elements with spec="UpDownOperator" containing the tree as "up" or "down" input.</li>
</ul>


For a *BEAST analysis (one generated in BEAUti using the StarBeast template) the same applies to gene trees, but the species tree uses a NodeReheight operator that changes both topology and internal node heights.
